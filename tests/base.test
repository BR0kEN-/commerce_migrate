<?php

abstract class CommerceMigrateBaseTest extends CommerceBaseTestCase {

  protected $storeAdmin;

  /**
   * {@inheritdoc}
   */
  protected function permissionBuilder($set) {
    $permissions = parent::permissionBuilder($set);

    switch ($set) {
      case 'store admin':
      case 'site admin':
        $permissions[] = MIGRATE_ACCESS_BASIC;
        $permissions[] = MIGRATE_ACCESS_ADVANCED;
        break;
    }

    return $permissions;
  }

  /**
   * {@inheritdoc}
   */
  protected function setUp() {
    parent::setUp(parent::setUpHelper('all', static::extraModules()));

    // Make sure the migrations are registered.
    migrate_static_registration();

    $this->storeAdmin = $this->createStoreAdmin();

    if (!$this->storeAdmin) {
      $this->fail(t('Failed to create Store Admin user for test.'));
    }

    // Set the default country to US.
    variable_set('site_default_country', 'US');
  }

  /**
   * Returns list of additional modules for enable before test will be run.
   *
   * @return string[]
   *   List of module names.
   */
  protected static function extraModules() {
    return array(
      'migrate',
      'migrate_extras',
      'commerce_migrate',
      'commerce_migrate_example',
    );
  }

}
